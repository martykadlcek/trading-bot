<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>MM Bot</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="../res/chart.css">
  <link rel="stylesheet" href="../res/ui.css">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="icon" type="image/png" href="../res/icon64.png" />
</head>
<body onload="app_start();">
<template id="trader_form">
<x-form class="pair no_adv sections">
<x-section><x-section-caption>Info</x-section-caption>
<div class="toppanel">
<div class="pairactions">
	<div class="icon" data-name="icon_undo"><img src="../res/undo.png" title="Undo changes" ></div>
	<div class="icon" data-name="icon_trading"><img src="../res/trading.png" title="Trading UI" ></div>
	<div class="icon" data-name="icon_broker" hidden="hidden"><img src="../res/broker_settings.png" title="Broker settings" ></div>
	<div class="icon" data-name="icon_reset"><img src="../res/reset_stats.png" title="Clear statistics"></div> 
	<div class="icon" data-name="icon_repair"><img src="../res/repair.png" title="Restart strategy" > </div>
	<div class="icon" data-name="icon_share"><img src="../res/share.png" title="Share settings" > </div>
	<div class="icon red" data-name="icon_delete"><img src="../res/delete.png" title="Delete trader"></div></div>
<div>
<x-checkbox data-name="advanced">Show&nbsp;all</x-checkbox>
</div>
</div>

<label><span>ID</span><span data-name="id" ></span></label>
<label><span>Broker</span><span><img src="" data-name="broker_img" class="inline_img">
	<span data-name="broker_id"></span> (<span data-name="broker"><span class="spinner fast inline"></span></span> <span data-name="broker_ver"></span>)<br/>
	<span class="no_api_key" data-name="no_api_key" hidden="hidden">⚠️ - Missing API key</span>
	<span class="no_api_key" data-name="api_key_not_saved" hidden="hidden">⚠️ - API key is not active yet</span></span>
	</label>


<label><span>Symbol</span><span data-name="symbol" ></span></label>
<div class="label"><span>Balance:</span><div><span data-name="balance_asset"></span> <span data-name="asset" ></span><br>
                                             <span data-name="balance_currency"></span> <span data-name="currency" ></span>
                                             </div></div>
<div class="label"><span>Calculated position:</span><div><span data-name="hdr_position"></span> <span data-name="asset" ></span> <button data-name="sync_pos" hidden="hidden">Sync</button></div></div>
<div class="label"><span>Price</span><span data-name="price"></span></div>
<div class="label"><span>Leverage</span><span data-name="leverage"></span></div>
<div data-name="open_orders_sect" hidden="hidden"><table class="orders"><caption>Open orders</caption>
<tr><th>ID</th><th>Direction</th><th>Price</th><th>Size</th></tr>
<tr data-name="orders[]"><td data-name="id">123456</td><td data-name="dir">buy</td><td data-name="price">123456</td><td data-name="size">123456</td><td data-name="action"></td></tr>
</table></div>
<div class="warning" data-name="err_failed_to_fetch">Failed to fetch</div>
</x-section>
<x-section><x-section-caption>General</x-section-caption>
<label><span>Title</span><input type="text" data-name="title"></label>
<label><span>Strategy</span><select data-name="strategy">
<option value="plfrompos">Linear</option>
<option value="hyperbolic">Hyperbolic</option>
<option value="stairs">Stairs</option>
<option value="halfhalf">Half-Half</option>
<option value="keepvalue">Keep Value</option>
</select></label>
<div class="label strategygoal"><span>Startegy Goal:</span><div data-name="help_goal">
<div class="plfrompos">A simple strategy for trading on leveraged stock exchanges and futures, generally on stock exchanges with the ability to open long or short positions. This strategy is the only one that works well with a negative value in "assets" (meaning position)</div>
<div class="halfhalf">This strategy keeps the value of assets and money on the stock exchange in a ratio 1:1. Whenever this ratio is disrupted, the strategy executes a trade in such a volume to achieve the defined ratio.</div>
<div class="keepvalue">This strategy keeps the value of assets on the stock exchange at the same value. If the value of assets falls or rises (due to changing price), the strategy executes a trade in such a volume to achieve the same value of the assets as before.</div>
</div></div>
<div class="label"><span>Options</span><div>
<div><x-checkbox data-name="enabled">Enable automatic trading</x-checkbox></div>
<div><x-checkbox data-name="dry_run">Paper trade (simulation)</x-checkbox></div>
<div><x-checkbox data-name="hidden">Hidden</x-checkbox></div>
</div></div>
<div class="label adv"><span>Strategy state (<span class="link" data-name="advedit">modify</span>)</span><x-section>
	<div class="label" data-name="strategy_fields[]"><span data-name="key"></span><input type="text" readonly="readonly" data-name="value"></div>
	</x-section></div>
</x-section>
<x-section data-name="strategy_halfhalf" class="goal" hidden="hidden"><x-section-caption>Half-Half/Keep Value</x-section-caption>
<label><span>External assets <span class="tooltip">Amount of assets held outside of exchange. They are included into calculations.</span></span><input type="number" step="any" data-name="external_assets"></label>
<label  class="adv"><span>Accumulation <span class="tooltip">Amount of the profit used to buy extra assets</span></span><x-slider data-name="acum_factor" data-min="0" data-max="100" data-mult="1"></x-slider></label>
<label class="adv" data-name="kv_valinc_h"><span>Change kept value over time <span style="white-space: nowrap">(<span data-name="currency"></span> monthly)</span><span class="tooltip">
This option is designed for regular investments. The value of held assets is increased monthly by a
fixed constant. The robot is forced to buy assets, but if the price of assets rises faster, it can
sell part of the assets and use the currency to buy assets at a better price. It is also possible
to enter a negative value and then the value of the assets held will decrease and allow slower but more efficient sales.</span></span>
<input type="number" step="any" data-name="kv_valinc"></label>
<label class="adv" data-name="kv_valinc_h"><span>Achieve half/half on account<span class="tooltip">
Controls accumulation and adjusts Keep to slovly achieve assets value equal to currency value at current price. You can control strength by "accumulation".
Function will accumulate assets, if there is more currencies than assets. It will release assets if there is more assets then fiat. External assets are
included, external currencies are counted in proportion to external assets</span></span><x-checkbox data-name="kv_halfhalf">Enabled</x-checkbox></label>
<div class="warning" data-name="err_external_assets">Unable to trade - This strategy requies to fund account with some assets [<span data-name="asset"></span>].  You can also set the "external assets" field above <span data-name="external_assets_hint">0</span>. It is generally recommended to have ratio between the value of the assets [<span data-name="asset"></span>] (including external assets) and the currrency [<span data-name="currency"></span>] (including external currencies) at 1:1</div>
<div class="warning" data-name="err_external_assets_margin">Unable to trade - This strategy needs to have a <b>long position</b> opened. You can also set external assets above <span data-name="external_assets_hint">0</span></div>
<div class="warning" data-name="err_external_assets_inverse">Unable to trade - This strategy needs to have a <b>short position</b> opened. You can also set external assets above <span data-name="external_assets_hint">0</span></div>

<x-section>
<div class="label"><span>Min price:</span><span data-name="halfhalf_min_price">---</span></div>
<div class="label"><span>Max price:</span><span data-name="halfhalf_max_price">---</span></div>
</x-section>
<div class="rightinfo"><button name="show_backtest" disabled="disabled">Backtest</button></div>
</x-section>

<x-section data-name="strategy_hyperbolic" class="goal" hidden="hidden"><x-section-caption>Hyperbolic</x-section-caption>
<label><span>Power<span class="tooltip">How balance is multiplied. Can boost profits and losses as well. Conservative value is 1</span></span><input data-name="hp_power" type="number" step="0.1" value="1.0"></label>
<label class="adv"><span>Dynamic power<span class="tooltip">How much is power adjusted with increase of the position</span></span><input data-name="hp_powadj" type="number" step="0.1" value="1.0"></label>
<label><span>External balance<span class="tooltip">Amount of balance held outside of stock. It allows to keep minimal amount of colateral on the leveraged stockmarket to prevent a large liquidations, but it still maintains  correct calculations with whole possible balance</span></span><input data-name="hp_extbal" type="number" value="0"></label>
<label><span>Asymmetry</span><span class="tooltip">Prefer one of sides. Positive value prefers LONGS on normal futures and SHORTS on inverted futures. Negative values vice versa. Note that negative values are more dangerous and can result in a liquidation.</span><x-slider data-name="hp_asym" data-min="-100" data-max="100" data-mult="1" data-fixed="0"></label>
<label><span>Reduction</span><span class="tooltip">Reduction of current position, 0=no reduction, 100=large reduction</span><x-slider data-name="hp_reduction" data-min="0" data-max="100" data-mult="1" data-fixed="0"></label>
<label class="adv"><span>Dynamic reduction<span class="tooltip">How much is reduction increased with increase of the position. The value 1 means by 100% when position is exact to internal multiplicator (advenced feature)</span></span><input data-name="hp_dynred" type="number" step="0.1" value="1.0"></label>
<label><span>Max loss (stoploss, 0=disabled)<span class="tooltip">Specify maximum loss to execute stoploss order. By setting 0 can result in a liquidation. In this case consider to keep minimum amount of the avaiable assets on the stockmarket and set the External balance to achieve correct caulculations</span></span><input data-name="hp_maxloss" type="number" value="0"></label>
<div class="rightinfo"><button name="show_backtest" disabled="disabled">Backtest</button></div>
</x-section>

<x-section data-name="strategy_stairs" class="goal" hidden="hidden"><x-section-caption>Stairs</x-section-caption>
<label class="adv"><span>Trading mode</span><select data-name="st_tmode">
<option value="auto" selected="selected">Auto</option>
<option value="exchange">Exchange</option>
<option value="margin">Margin</option>
</select></label>
<label><span>Power (<span data-name="st_show_factor"></span>x)<span class="tooltip">Specifies power of 10 multiplier of current balance used to automatically calculate the step (for 1% of movement). <br><br>Use <strong>0.5</strong> for <strong>cryptocurrencies</strong> <br>and values between <strong>3-4</strong> for <strong>Forex</strong></span></span><x-slider data-name="st_power" data-min="0.01" data-max="5" data-mult="0.01" data-fixed="2"></x-slider></label>
<label><span>Max steps<span class="tooltip">TBD</span></span><x-slider data-name="st_max_step" data-min="1" data-max="50" data-mult="1" data-fixed="0"></x-slider></label>
<div class="label ttb"><span><select data-name="st_redmode">
	<option value="stepsBack" selected="selected">N steps back</option>
	<option value="reverse">Close/Reverse</option>
	<option value="lockOnReduce">Locked step</option>
	<option value="lockOnReverse">One-way steps</option>
</select></span><x-slider data-name="st_reduction_step" data-min="0" data-max="50" data-mult="1" data-fixed="0"></x-slider></div>
<label><span>Series</span><select data-name="st_pattern">
<option value="constant">Linear increase</option>
<option value="harmonic">Harmonic (1,1.5,1.83,2.083,...)</option> 
<option value="sqrt">Square root(1,1.4,1.7,2,2.2...)</option>
<option value="arithmetic">Arithmetic (1,3,6,10,15,...)</option>
<option value="exponencial">Exponencial (1,2,4,8,16...)</option>
<option value="parabolic">Parabolic</option>
<option value="poisson1">Poisson μ=1</option>
<option value="poisson2">Poisson μ=2</option>
<option value="poisson3">Poisson μ=5</option>
<option value="poisson4">Poisson μ=7</option>
<option value="poisson5">Poisson μ=11</option>
</select></label>
<label class="adv"><span>Options</span><span><x-checkbox data-name="st_sl">Stoploss</x-checkbox></span></label>
<div class="rightinfo"><button name="show_backtest" disabled="disabled">Backtest</button></div>
</x-section>
<x-section data-name="strategy_pl backtest_anchor" class="goal" hidden="hidden"><x-section-caption>Linear</x-section-caption>
<label><span>Configuration mode</span><select name="pl_confmode"><option value="a">Automatic</option><option value="m">Manual</option></select></label>
<label data-name="pl_mode_a"><span>Power (<span data-name="pl_show_factor"></span>x)<span class="tooltip">Specifies power of 10 multiplier of current balance used to automatically calculate the step (for 1% of movement). <br><br>Use <strong>0.5</strong> for <strong>cryptocurrencies</strong> <br>and values between <strong>3-4</strong> for <strong>Forex</strong></span></span><x-slider data-name="pl_power" data-min="0.01" data-max="5" data-mult="0.01" data-fixed="2"></x-slider></label>
<label data-name="pl_mode_a" class="adv"><span>Balance to use</span><x-slider data-name="pl_baluse" data-min="1" data-max="100" data-mult="1" data-fixed="0"></x-slider></label>
<label data-name="pl_mode_m"><span>Position for 1% movement: <span class="tooltip"
>Specifies how much currency is used in 1% momement of the price. </span></span><input data-name="cstep" type="number" step="any"></label>
<label data-name="pl_mode_m"><span>Max position (0&nbsp;=&nbsp;disabled)<span class="tooltip"
>Specifies maximum position in both sides (short or long) for normal trading. This doesn't mean, that trading will
stop beyond this limit, however the strategy focuses on position reduction regadless on possible loss. This also
doesn't work as stoploss, because position can still grow beyoind the limit, but a lot of slower.</span></span><input data-name="max_pos" type="number" step="any">
</label>
<label class="adv"><span>Neutral position offset <span class="tooltip"
>Sets offset to neutral position, the strategy will reduce to this position</span></span><input data-name="pl_posoffset" type="number" step="any">
</label>
<div class="adv label ttb"><span><select data-name="pl_redmode">
		<option value="stableProfit">Stable norm.profit</option>
		<option value="rp">RP reduction  [%]</option>
		<option value="fixed">Fixed reduction [%]</option>
		<option value="openp">Toward opening price</option>
		<option value="ema">EMA (10xtrades)</option>
		<option value="npmove">Sliding zero [‰]</option>
		</select><br>
		<span class="tooltip">Specifies factor of position reduction.<br><br>
		<strong>Sliding zero</strong> - Absolute position is calculated using
		difference between current price and neutral price. The neutral price is slightly sliding towards to current price after each trade.
		The value specifies amount of move per trade in per mille<br><br>
		<strong>Fixed</strong> - position is reduces by a fixed amount, which
		decreases profit (and turns to potential loss) with raise of the position.<br><br> 
		
		<strong>RP</strong> - (realized profit) reduction uses current realized profit to
		reduce current position. Note that unrealized loss increases by square, while
		realized profit is linear, so larger positions are reduced less than
		smaller positions</span></span>
		<x-slider data-name="pl_redfact" data-min="0" data-max="100" data-mult="1"></x-slider></div>
<label class="adv"><span>Options<span class="tooltip">Reduce opening orders - runs reduction function also for opening orders which causes, that position may be opened less than calculated. This would be generally safer option, however it also reduces potentional profit significantly</span></span><x-checkbox data-name="pl_redoninc">Also reduce opening orders</x-checkbox></label>
<div class="rightinfo"><button data-name="linear_suggest pl_mode_m">Propose</button><button data-name="linear_suggest_maxpos  pl_mode_m">Propose max position</button></div>
<div class="warning" data-name="err_toolargepos">Changing setting is discouraged because the open position is too large</div>
<div class="warning" data-name="err_invalid_values">Unable to trade - invalid values</div>
<div class="rightinfo"><button name="show_backtest" disabled="disabled">Backtest</button></div>
<x-section>
<div class="label"><span>Max in position</span><span><span data-name="linear_max_in_pos">---</span>&nbsp;<span data-name="currency"></span></span></div>
<div class="label"><span>Min price:</span><span data-name="linear_min_price">---</span></div>
<div class="label"><span>Max price:</span><span data-name="linear_max_price">---</span></div>
</x-section>

</x-section>
<x-section class="adv" ><x-section-caption>Common</x-section-caption>
<label  class="adv"><span>Order minimal size (0&nbsp;=&nbsp;disabled)<span class="tooltip">
Specifies minimal order size. If disabled, minimal size is defined by the exchange. This also
specifies size of the "dust order"
</span></span><input type="number" data-name="min_size" step="any"></label>
<label  class="adv"><span>Order maximal size (0&nbsp;=&nbsp;disabled)<span class="tooltip">
Specifies maximal order size. 
</span></span><input type="number" data-name="max_size" step="any"></label>
<label  class="adv"><span>Order size modifier [%]<span class="tooltip">It is recomended to set values below
100. This makes orders smaller but also causes that order will be split into smaller orders. For
example if you specify value 50, the order 24 may be split to orders 12, 6, 3, 2, 1 = 24. This can
help to push the "average open price" near to the current price
</span></span><x-slider data-name="order_mult" data-min="1" data-max="199" data-mult="1" data-fixed="0"></x-slider></label>
<label class="adv"><span>Accept loss after hours (0&nbsp;=&nbsp;disabled)<span class="tooltip">
Enable to the Bot accept partial loss, when trading is not possible due insufficient balance or when
"Hard max position" is reached. The value specified amount of hours after last trade, when
extra "virtual" trade with zero size is generated to shift the center of the spread. This can
reenable trading, but it also finally costs some profit
</span></span><input type="number" data-name="accept_loss" step="1"></x-slider></label>
<label  class="adv"><span>MIN asset balance/position<span class="tooltip">
Specifies minimum allowed asset balance (or position, for short use negative value). When balance hits this value, no futher sells are allowed. In this situation 'Accept loss' rule can be applied
</span></span><input type="number" data-name="min_balance" step="any"></label>
<label  class="adv"><span>MAX asset balance/position<span class="tooltip">
Specifies maximum allowed asset balance (or position, for short use negative value). When balance hits this value, no futher buys are allowed. In this situation 'Accept loss' rule can be applied
</span></span><input type="number" data-name="max_balance" step="any"></label>
</x-section>
<x-section class="adv" data-name="spread_vis_anchor"><x-section-caption>Spread</x-section-caption>
<label  class="adv"><span>Spread width: st.dev hours <span class="tooltip"
>Specifies how many hours is used to calculate a standard deviation for spread value</span></span><x-slider data-name="spread_calc_stdev_hours" data-min="1" data-max="240" data-mult="1"></x-slider></label>
<label  class="adv"><span>Spread width: smooth hours <span class="tooltip"
>Specifies smooth in hours. The program uses SMA (simple moving average) to calculate volatility smooth. By setting 1, it means, deviation longest than 1 hour is not considered as local deviation.</span></span><x-slider data-name="spread_calc_sma_hours" data-min="1" data-max="240" data-mult="1"></x-slider></label>
<label  class="adv"><span>Spread width: manual adjust <span class="tooltip"
>Specify manual adjust. Values above zero causes wider spread up to 2x. Values below zero causes narrow spread up to 1/2</span></span><x-slider data-name="spread_mult" data-min="-100" data-max="100" data-mult="1" data-fixed="0"></x-slider></label>
<label class="adv"><span>Dynamic spread mult. raise<span class="tooltip"
>Specifies [in %] how much is dynamic multiplicator raised after trade.</span></span><x-slider data-name="dynmult_raise" data-min="1" data-max="1000" data-mult="1"></x-slider></label>
<label class="adv"><span>Dynamic spread mult. fall<span class="tooltip"
>Specifies [in %] how much is dynamic multiplicator falls every minute without trade.</span></span><x-slider data-name="dynmult_fall" data-min="0.1" data-max="10" data-mult="0.1" data-fixed="1"></x-slider></label>
<label class="adv"><span>Dynamic spread behaviour</span><select data-name="dynmult_mode">
<option value="disabled">Disabled</option>
<option value="independent"  selected="selected">Independent</option>
<option value="together">Together</option>
<option value="alternate">Alternate</option>
<option value="half_alternate">Half alternate</option>
</select></label>
<div class="label adv"><span>Options</span><div>
<div><x-checkbox data-name="dynmult_mult">Multiply factor</x-checkbox></div>
<div><x-checkbox data-name="dynmult_scale">Scale with dynamic spread</x-checkbox></div>
<div><x-checkbox data-name="dynmult_sliding">Sliding (can break rule: buy low, sell high)</x-checkbox></div>
</div></div>
<div class="rightinfo"><button name="vis_spread"  disabled="disabled">Visualize spread</button></div>
</x-section>
<x-section class="adv"><x-section-caption>Misc</x-section-caption>
<div class="label adv"><span>Options<span class="tooltip"
><strong>Internal balance</strong> - track balance by trades - do not use balance from exchange<br><br>
<strong>Alerts</strong> - Enables to use alerts when strategy is unable to put order in reasonable distance from the current price. Alert allows to recalculate strategy when price crosses the alert price but without actual trading. The crossed alerts are reported in the list of the trades. Note that strategy can still use alerts even if this option is disabled<br><br>
<strong>Delayed alerts</strong> - Enables delaying the alert after some time from the last trade. The time is specified by the value <em>Accept&nbsp;loss</em>. If the <em>Accept&nbsp;loss</em> is zero, then time is calculated as average period between (real) trades<br><br>
 </span></span><div>
<div><x-checkbox data-name="internal_balance">Internal balance</x-checkbox></div>
<div><x-checkbox data-name="alerts">Alerts</x-checkbox></div>
<div><x-checkbox data-name="delayed_alerts">Delayed alerts</x-checkbox></div>
</div>
</div>
<label class="adv"><span>Report - position offset<span class="tooltip">Allows to sync the position on the report page with the actual state on the echange.<br>
The position is not generally in the sync due to various issues. You need to specify a difference between the calculated position presented on the report page and the actual position on the exchhange
</span></span><input type="number" step="any" data-name="report_position_offset"></label>
<label class="adv"><span>Ordering (position in the report)<span class="tooltip">Specifies order in report page. The traders are ordered by this ascending number. If there are two traders with
the same order, they are ordered by its ID - this is the default ordering. Modifying this number you can change the default ordering.
</span></span><input type="number" step="any" data-name="report_order"></label>
<label class="adv"><span>Force spread [%](0=disabled)<span class="tooltip">Specifies exact spread in % width and disables the internal spread detection</span></span><input type="number" step="any" data-name="force_spread"></label>
</x-section>
<div></div>
</x-form>
</template>

<template id="trader_list">
<div class="trader list">
<div class="item" data-name="item[]">
<img src="" data-name="image">
<div data-name="caption"></div>
</div>
</div>
</template>

<template id="desktop"><div class="desktop vertical">
<div class="top_panel" data-name="top_panel"></div>
<div class="menu" data-name="menu"></div>
<div class="content" data-name="content"></div>
</div>
</template>

<template id="broker_select">
<div class="dialog">
<div class="broker select">
<h2>Select broker</h2>
<div class="trader list">
<div class="item" data-name="item[]">
<img src="" data-name="image">
<div><span data-name="caption"></span><span data-name="excl_info" class="no_api_key" hidden="hidden">⚠️</span></div>
</div>
</div>
<div class="no_api_key" data-name="excl_info" hidden="hidden">⚠️ - Missing API key</div>
<button data-name="cancel">Cancel</button>
</div>
</div>
</template>

<template id="broker_pair">
<div class="dialog">
<div class="broker pair">
<div class="form">
<img src="" data-name="image">
<h2>Select pair</h2>
<select data-name="pair"><option data-name="item[]"></option></select> <div data-name="spinner" class="spinner fast"></div>
<h2>Enter trader's UID</h2>
<input type="text" data-name="name">
</div>
<button data-name="ok">OK</button>
<button data-name="cancel">Cancel</button>
</div>
</div>
</template>

<template id="top_panel">
<div class="flexpanel">
<div><a href="../"><span class="fonticon backicon">&lt;</span></a> MMBot administration</div>
<div>
<div data-name="login" class="panelbutton">
	<img src="../res/security.png" class="fonticon"> Login 
</div>
<div data-name="save" class="panelbutton" hidden="hidden">
	<img src="../res/save_icon.png" class="fonticon"> Apply settings <div data-name="saveok"  class="save hide ok" hidden="hidden">✓</div>
	<div data-name="saveprogress" class="save spinner fast" hidden="hidden"></div></div>
</div>
</div>
</template>

<template id="main_form_wait">
<div class="main_form_wait">
<x-form class="pair sections">
<x-section><x-section-caption>Info</x-section-caption>
<div class="spinner"></div>
</x-section>
</x-form>
</div>

</template>

<template id="security_form">
<x-form  class="pair security_form sections">
<x-section><x-section-caption>Access control</x-section-caption>
<table>
<tr><th>User</th><th>Role</th><th>Comment</th><th>Action</th></tr>

<tr data-name="rows[]">
<td data-name="user"></td>
<td><select data-name="role">
<option value="admin">Administrator</option>
<option value="viewer">Viewer</option>
</select></td>
<td data-name="comment"></td>
<td><button data-name="drop" data-question="Confirm drop user: ">Drop</button></td>
</tr>
<tr><td>&lt;public&gt;</td><td><select data-name="guest_role">
<option value="none">No access</option>
<option value="viewer">Viewer</option></select></td>
<td>All anonymous visitors</td><td>&nbsp;</td>
</tr>
</table>
<div class="buttons">
<button class="logout" data-name="logout"><img src="../res/logout.png">&nbsp;Logout</button>
<button class="add" data-name="add"><img src="../res/adduser.png">&nbsp;Add&nbsp;user</button>
</div>
</x-section>
<x-section class="apikeys"><x-section-caption>API Keys</x-section-caption>
<table>
<tr><th>Broker</th><th>Exchange</th><th>State</th><th>Action</th><th>Sub</th><th>Info</th></tr>
<tr data-name="brokers[]">
<td><img src="" data-name="img"><span data-name="broker"></span></td>
<td><a href="" data-name="exchange" target="_blank"></a></td>
<td data-name="state"><div class="spinner fast inline"></div></td>
<td><button data-name="bset" disabled="disabled">Set</button><button data-name="berase" disabled="disabled">Erase</button></td>
<td><img  data-name="sub_button" src="../res/addsub.png"></td>
<td data-name="info_button">🛈</td>
</table>
<span class="no_api_key" data-name="need_save" hidden="hidden">⚠️ - Remember to click on the Apply button to make settings take an effect</span>
<div class="waitdlg"  data-name="spinner">
<div class="spinner"></div>
</div>
</x-section>
</x-form>
</template>

<template id="add_user_dlg">
<div class="dialog">
<div class="add user">
<x-form>
<h2>Add user</h2>
<label><span>Username:</span><input type="text" data-name="username"></label>
<label><span>Comment:</span><textarea data-name="comment" rows="3" cols="40"></textarea></label>
<button data-name="ok">Add</button>
<button data-name="cancel">Cancel</button>
</div>
</div>
</template>

<template id="password_dlg">
<div class="dialog"><div class="add user">
<x-form>
<h2>Please new enter password:</h2>
<label><span>Username:</span><input type="text" data-name="username" readonly="readonly" tabindex="-1"></label>
<label><span>Password:</span><input type="password" data-name="pwd"></label>
<label><span>Retype password:</span><input type="password" data-name="pwd2"></label>
<div class="error" data-name="errpwd">Passwords are not same</div>
<button data-name="ok">OK</button>
<button data-name="cancel">Cancel</button>
</x-form>
</div></div>
</template>

<template id="subaccount_dlg">
<div class="dialog"><div class="subaccount_dlg">
<x-form>
<h2>Add sub-account:</h2>
<p>Enter any short unique name:<br/><input type="text" data-name="name"></p>
<button data-name="ok">OK</button>
<button data-name="cancel">Cancel</button>
</x-form>
</div></div>
</template>

<template id="share_dlg">
<div class="dialog"><div class="sharedlg">
<x-form>
<h2>Share the settings</h2>
<p>Share following block, or click on "import" to import another settings</p>
<textarea name="share_input"></textarea>
<button data-name="import">Import</button>
<button data-name="copy">Copy</button>
<button data-name="paste">Paste</button>
<button data-name="ok">Apply</button>
<button data-name="cancel">Close</button>
</x-form>
</div></div>
</template>


<template id="confirm">
<div class="dialog">
<div class="confirm">
<h2 data-name="hdr"></h2>
<p data-name="text"></p>
<div data-name="custom"></div>
<button data-name="ok">OK</button>
<button data-name="cancel">Cancel</button>
</div>
</div>
</template>

<template id="broker_options_dlg">
<div class="dialog">
<div class="confirm">
<h2 data-name="hdr">Broker options</h2>
<div data-name="form"><div class="waitdlg"><div class="spinner"></div></div></div>
<button data-name="ok">OK</button>
<button data-name="cancel">Cancel</button>
</div>
</div>
</template>


<template id="network_error">
<div class="dialog">
<div class="confirm">
<p>Unable to fetch data from the server</p>
<p data-name="text"></p>
<p data-name="desc"></p>
<button data-name="ok">OK</button>
</div>
</div>
</template>

<template id="validation_error">
<div class="dialog">
<div class="confirm">
<h2>Can't apply the new settings</h2>
<p data-name="text"></p>
<button data-name="ok">OK</button>
</div>
</div>
</template>


<template id="waitdlg">
<div class="dialog">
<div class="waitdlg">
<div class="spinner"></div>
<div></div>
</div>
</div>

</template>

<template id="spread_vis">
<x-section class="backtest"><x-section-caption>Spread visualizer</x-section-caption>
<div class="charts spread_vis">
<div data-name="chart1"><div><em>Loading data, please wait...</em></div></div>
<div data-name="chart2"></div>
<div class="spinner fast save" data-name="spinner" hidden="hidden"></div>
</div>
</x-section>
</template>

<template id="backtest_vis">
<x-section class="backtest"><x-section-caption>Backtest</x-section-caption>
<div class="tablecont up"><table>
<tr>
<th class="a" data-name="showpl">p&amp;l</th>
<th class="a" data-name="showpl">p&amp;l/y</th>
<th class="a" data-name="showpl">p&amp;l p.a.</th>
<th class="a" data-name="showpl">max pos</th>
<th class="a" data-name="shownorm">norm</th>
<th class="a" data-name="shownorm">norm/y</th>
<th class="a" data-name="shownorm">norm p.a.</th>
<th class="a" data-name="shownorm">max cost</th>
<th>max profit</th><th colspan="2">downdraw</th><th>RRR</th><th rowspan="2" data-name="options"><img src="../res/options.png" ></tr>
<tr>
<td class="colornumb a" data-name="pl showpl"></td>
<td class="colornumb a" data-name="ply showpl"></td>
<td class="colornumb a pc" data-name="pc showpl"></td>
<td class="colornumb a" data-name="max_pos showpl"></td>
<td class="colornumb a" data-name="npl shownorm"></td>
<td class="colornumb a" data-name="nply shownorm"></td>
<td class="colornumb a pc" data-name="npc shownorm"></td>
<td class="colornumb a" data-name="max_cost shownorm"></td>
<td class="colornumb" data-name="max_profit"></td>
<td class="colornumb" data-name="max_loss"></td>
<td class="colornumb sell pc" data-name="max_loss_pc"></td>
<td class="colornumb" data-name="pr"></td>
</tr>
</table>
</div>

<div class="charts spread_vis">
<div data-name="chart1"><div><em>Loading data, please wait...</em></div></div>
<p>Price / neutral price</p>
<div data-name="chart2"></div>
<p>Profit from position / normalized profit</p>
<div class="spinner fast save" data-name="spinner" hidden="hidden"></div>
<div><input name="pos" type="range" min="-100" max="0" step="0.1" value="0" class="thick"></div>
</div>
<div class="tablecont bottom"><table>
<tr>
<th>Trades</th>
<th>Buys</th>
<th>Sells</th>
<th>Alerts</th>
<th>Ascents</th>
<th>Descents</th>
<th>Max streak</th>
<tr>
<td data-name="trades"></td>
<td data-name="buys"></td>
<td data-name="sells"></td>
<td data-name="alerts"></td>
<td data-name="ascents"></td>
<td data-name="descents"></td>
<td data-name="streak"></td>
</tr>
</table>
</div>

<x-form class="floating" hidden="hidden" data-name="options_form">
<div class="backtesticons">
	<div class="icon" data-name="select_file"><img src="../res/upload_data.png" title="Upload 1minute data or exported trades in CSV" ></div>
	<div class="icon" data-name="icon_internal"><img src="../res/internal_data.png" title="Use internal data"></div> 
	<div class="icon" data-name="icon_recalc"><img src="../res/recalc_data.png" title="Recalculate spread" ></div>
	<div class="icon" data-name="export"><img src="../res/export_csv.png" title="Export CSV" > </div>
	<div class="icon" data-name="icon_reset"><img src="../res/repair.png" title="Reset data" ></div>
</div>
<input hidden="hidden" type="file"  data-name="price_file">
<label><span>Start date</span><input type="date" data-name="start_date"></label>
<label><span>Currency</span><input type="number" step="any" data-name="initial_balance"></label>
<label><span>Assets/Position</span><input type="number" step="any" data-name="initial_pos"></label>
<label><span>Show: neutral price</span><x-checkbox data-name="show_op">open price</x-checkbox></label>
<label><span>No slippage on stoploss</span><x-checkbox data-name="fill_atprice"></x-checkbox></label>
</x-form>
</x-section>
</template>

<span id="strtable"
    data-askcancel="Do you want to cancel all orders?&#10;This will also temporarily stop auto trading until you click Apply button"
    data-askreset="Do you wish to clear statistics for this trader? This operation cannot be undone"
    data-askrepair="This operation resets an internal state of the strategy. The purpose of this operation to solve any strange behaviour of the strategy. However, this can also cause poor performance or loss, because the internal state of the strategy can hold important informations about state of your trading.&#10;&#10;Do you wish to restart strategy for this trader?&#10;&#10;The operation cannot be undone"
    data-askdelete="Confirm trader deletion. This also cancels all orders."
    data-yes="Yes"
    data-no="No"
    data-reload="↻ Reload"
    data-need_admin="You need to define at least one user with the administration role"
    data-backtest_lesstrades="There are less than 100 trades. Results can be inaccurate"
    data-backtest_nodata="Backtest is not available yet (no data). Run trader with minimal power to collect some trades. At least 100 trades is needed."
    data-access_control="Access control"
    data-options="Options"
    data-global_stop_confirm="Temporarily stops trading for all configured traders  and cancels all their orders. To re-enable trading, you have to click Apply button"
    data-conflict1="Configuration has been modified externally and cannot be overwritten."
    data-conflict2="Reload the configuration?"
    data-buy="BUY"
    data-sell="SELL"
    data-trade_ask_stop="This trader is currently in auto trading mode. Do you want to stop automatic trading to allow manual trading? To re-enable trading, you have to click Apply button"
    data-please_login="Your session has expired. Please log in to contine"
    data-import_failed="Import failed. The code is probably damaged"
    data-import_invalid_format="Unrecognized File Format"
    ></span>


	
	
<template id="options_form">
<x-form  class="pair options_form sections">
<x-section><x-section-caption>Options</x-section-caption>
<label><span>How many days of history to show in charts: </span><x-slider data-min="1" data-max="60" data-mult="1" data-name="report_interval"></x-slider></label>
<!-- <label><span>Size of backtest [days]: </span><x-slider data-min="1" data-max="60" data-mult="1" data-name="backtest_interval"></x-slider></label> -->
</x-section>
<x-section><x-section-caption>Troubleshoting</x-section-caption>
<div class="trouble_sect"><div>Temporarily stops trading for all configured traders  and cancels all their orders. To re-enable trading, you have to click Apply button<div><button data-name="stop">Global Stop</button></div></div>
<div>Reloads all brokers. This can fix some problems with certain brokers<div><button data-name="reload_brokers">Reload brokers</button></div></div>
</div>
</x-form>
</template>

	
<template id="trading_form">
<x-form class="trading sections">
<x-section class="wide backtest"><x-section-caption>Chart</x-section-caption>
<div class="chart" data-name="chart"><div class="spinner"></div></div>
</x-section>
<x-section class="small_box"><x-section-caption>Ticker</x-section-caption>
<label><span>Ask</span><input type="text" data-name="ask_price" readonly="readonly"></label>
<label><span>Last</span><input type="text" data-name="last_price" readonly="readonly"></label>
<label><span>Bid</span><input type="text" data-name="bid_price" readonly="readonly"></label>
<label><span>Balance assets</span><input type="text" data-name="bal_assets" readonly="readonly"></label>
<label><span>Balance currency</span><input type="text" data-name="bal_currency" readonly="readonly"></label>
</x-section>
<x-section  class="small_box"><x-section-caption>Open orders</x-section-caption>
<table class="orders">
<tr><th>Direction</th><th>Price</th><th>Size</th><th></th></tr>
<tr data-name="orders[]">
<td data-name="dir">buy</td>
<td data-name="price">123456</td>
<td data-name="size">123456</td>
<td><button data-name="cancel">X</button><div class="spinner fast" hidden="hidden" data-name="spinner"></div></td></tr>
</table>
</x-section>
<x-section class="center_box"><x-section-caption>New order</x-section-caption>
<label><span>Edit order</span><select name="edit_order"><option value="">-- new order --</option><option name="edit_orders[]" value=""></option></select></label>
<label><span>Order size</span><input type="number" step="any" data-name="order_size"></label>
<label><span>Price</span><input type="number" step="any" data-name="order_price"></label>
<div class="buttons">
<button data-name="button_buy" class="buy">BUY</button>
<button data-name="button_sell" class="sell">SELL</button>
<button data-name="button_buybid" class="buy">BUY at bid</button>
<button data-name="button_sellask" class="sell">SELL at ask</button>
</div>
</x-section>
</x-form>
</template>

<template id="upload_chart_wait">
<div class="dialog">
<div class="upload_dialog">
<p>Simulating trades, it takes a while</p>
<p>(Please, do not refresh the page)</p>
<div class="progress"><div data-name="progress"></div>
<span data-name="upload_mark">Uploading...</span>
<span data-name="process_mark" hidden="hidden">Processing...</span>
</div>
<button data-name="stop">Stop</button>
</div>
</div>
</template>

<template id="advedit_dlg">
<div class="dialog"><div class="adveditdlg">
<x-form>
<h2>Modify strategy state</h2>
<p>This feature is for advanced users. If you do not know what each value means, do not change it, because the change will probably result in a loss.</p>
<textarea name="json_data"></textarea>
<button data-name="ok">Apply</button>
<button data-name="cancel">Close</button>
</x-form>
</div></div>
</template>


<script src="../res/template.js" type="text/javascript"></script>
<script src="../res/common.js" type="text/javascript"></script>
<script src="../res/ui.js" type="text/javascript"></script>
<script src="code.js" type="text/javascript"></script>
</body>
</html>
